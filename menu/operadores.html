<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Operadores</title>
  <meta name='viewport' content='width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no' />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <style>
    .navbar-custom {
      background-color: #1e4f9e;
    }

    .margin-custom {
      margin-top: 120px;
      margin-left: 10px;
      margin-right: 10px;
    }

    .table-wrapper {
      max-height: 443px;
      overflow: auto;
    }

    .margin-custom-graphic {
      margin-top: 90px;
      margin-bottom: 30px;
    }
  </style>

</head>

<body>
  <header>

  </header>

  <main>



    <nav class="navbar  navbar-expand-lg navbar-custom fixed-top">
      <div class="collapse navbar-collapse container-fluid">
        <img src="./resources/grand_vision.jpg" alt="" width="100" class="d-inline-block align-top">
        <h1 style="color:beige">Operadores</h1>
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link nav-brand" href="menuPrincipal.html" style="color:beige">Menú principal</a></li>
          <li class="nav-item"><a class="nav-link nav-brand" href="../index.html" style="color:beige">Cerrar sesión</a></li>
        </ul>
      </div>
    </nav>

    <div class="row margin-custom">

      <div class="col-sm-6">
        <div class="card">
          <div class="card-header">
            <div class = "row">
              <div class = "col"> Lista de operadores </div>

              <div class = "col d-flex flex-row-reverse">
                <div class="dropdown">
                  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" name="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <em id="filtroTag" name="filtroTag"> Activo </em>
                    </button>

                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <li><a class="dropdown-item" onclick="Filtro('activo=1')"> Activo </a></li>
                      <li><a class="dropdown-item" onclick="Filtro('activo=0')"> Inactivo </a></li>
                    </ul>
                  </div>
                </div>
            </div>

          </div>
          <div class="card-body">
            <div class="container table-wrapper">
              <input class="form-control mb-4" id="busqueda" onkeyup="filtrar()" type="text" placeholder="Ingresa el número de empleado" pattern="^[0-9]{6}$">
              <table class="table table-hover" id="tablaOperadores">
                <thead>
                  <tr>
                    <th scope="col"> Número de empleado </th>
                    <th scope="col"> Nombre de empleado </th>
                  </tr>
                </thead>
                <tbody id="operador"></tbody>
              </table>
            </div>
          </div>
          <div class="card-footer">
            <div class="row">
              <div class="col-sm-4">
                <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#registro" onClick="resetForm('#Registrar','#operadoresMsg',)"> Registrar</button>
              </div>
              <div class="col-sm-4">
                <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modificar1" onClick="resetForm('#modificar1','#CambiarMsg')">Modificar</button>
              </div>
              <div class="col-sm-4">
                <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#eliminar1" onClick="resetForm('#eliminar1','#EliminarMsg')"> Eliminar </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="card">
          <div class="card-header">
            <div class="text-center">
              <img src="./resources/example.png" alt="" width="150" class="img-fluid" style="padding:1%">
              <h2>
                Información del empleado seleccionado
              </h2>
            </div>
          </div>
          <div class="card-body">
            <form>
              <div class="mb-3">
                <label for="nombre_operador" class="form-label">Nombre</label>
                <input type="text" class="form-control" id="nombre_operador">
              </div>
              <div class="mb-3">
                <label for="numero_empleado" class="form-label">Número de empleado</label>
                <input type="text" class="form-control" id="numero_empleado">
              </div>
            </form>
          </div>
        </div>
      </div>

    </div>


    <div class="modal fade" name="registro" id="registro" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Registro de operador</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onClick="resetForm('#Registrar','#operadoresMsg')"> </button>
          </div>
          <div class="modal-body">
            <em id="operadoresMsg"></em>

            <form class="row g-3" name="Registrar" id="Registrar" method="POST" onSubmit="return false;">
              <div class="col-12">
                <label for="inputNombre" class="form-label">Nombre <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="inputNombre" name="inputNombre" placeholder="Nombre completo del empleado" data-required>
              </div>
              <div class="col-12">
                <label for="inputNumeroEmpleado" class="form-label">Número del empleado <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="inputNumeroEmpleado" name="inputNumeroEmpleado" placeholder="Número de empleado" data-required>
              </div>
            </form>

          </div>
          <div class="modal-footer">

            <div class="col">
              <button type="button" class="btn btn-secondary float-left" data-bs-dismiss="modal" onClick="liderButton()"> Registrar líder de almacén </button>
            </div>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="resetForm('#Registrar','#operadoresMsg')">Cerrar</button>
            <button type="button" name="submit2" id="submit2" class="btn btn-primary" onClick="return formValidate('#Registrar','#operadoresMsg',$('#inputNumeroEmpleado').val());">Guardar</button>

          </div>
        </div>
      </div>
    </div>


    <div class="modal fade" name="lider1" id="lider1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel"> Registrar líder de almacén </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onClick="resetForm('#numeroLiderForm','#lider1Msg')" > </button>
          </div>
          <div class="modal-body">
              <div class="text-secondary"> El número de empleado debe ser parte de los operadores</div>
              <em id="lider1Msg"> </em>
            <form class="row g-3" name="numeroLiderForm" id="numeroLiderForm" method="POST" onSubmit="return false;">
              <div class="col-md-12">
                <label for="numeroLider" class="form-label"> Número de empleado del nuevo líder de almacén <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="numeroLider" name="numeroLider" placeholder="Número de empleado" data-required>
              </div>
            </form>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="resetForm('#numeroLiderForm','#lider1Msg')">Cerrar</button>
            <button type="button" name="submit6" class="btn btn-primary" onClick="return Validate_ModifyLider('#numeroLiderForm','#lider1Msg',$('#numeroLider').val(),'L');"> Buscar </button>
          </div>
        </div>
      </div>
    </div>


    <div class="modal fade" name="lider2" id="lider2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel"> Registrar líder de almacén </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
          </div>
          <div class="modal-body">
            <em id="lider2Msg"></em>

            <form class="row g-4" name="lider2Form" id="lider2Form" method="POST" onSubmit="return false;" oninput='lider2Password2.setCustomValidity(lider2Password2.value != lider2Password.value ? "Passwords do not match." : "")'>
              <div class="col-lg-6">

                <label for="lider2Usuario" class="form-label">Usuario</label>
                <input type="text" class="form-control" id="lider2Usuario" name="lider2Usuario" placeholder="Usuario" data-required>
                <p>
                  <label for="lider2Password" class="form-label">Contraseña:</label>
                  <input id="lider2Password" type=password data-required name="lider2Password" placeholder="********">
                <p>
                  <label for="lider2Password2" class="form-label">Confirmación de contraseña:</label>
                  <input id="lider2Password2" type=password name="lider2Password2" placeholder="********">
              </div>

            </form>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="resetForm('#lider2Form','#lider2Msg')">Cerrar</button>
            <button type="button" name="submit6" class="btn btn-primary" onClick="return Validate_Lider('#lider2Form','#lider2Msg',$('#numeroLider').val());"> Guardar </button>
          </div>
        </div>
      </div>
    </div>



    <div class="modal fade" id="exito" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Anuncio</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick=" location.reload();">
            </button>
          </div>
          <div class="modal-body">
            <h5 class="modal-title text-center" id="exampleModalLabel"> Operación realizada con exito </h5>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick=" location.reload();">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" name="modificar1" id="modificar1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modificar operador</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
          </div>
          <div class="modal-body">
            <em id="CambiarMsg"></em>
            <form class="row g-3" name="Cambiar" id="Cambiar" method="POST" onSubmit="return false;">
              <div class="col-md-12">
                <label for="inputCambiar" class="form-label"> Número de empleado <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="inputCambiar" name="inputCambiar" placeholder="Número de empleado" data-required>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="resetForm('#Cambiar','#CambiarMsg')">Cerrar</button>
            <button type="button" name="submit4" id="submit4" class="btn btn-primary" onClick="return Validate_Modify('#Cambiar','#CambiarMsg',$('#inputCambiar').val(),'O');"> Buscar </button>
          </div>
        </div>
      </div>
    </div>


    <div class="modal fade" name="modificar2" id="modificar2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modificación de operador</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
          </div>
          <div class="modal-body">
            <em id="ModificarMsg2"></em>
            <form class="row g-3" name="Modificar" id="Modificar" method="POST" onSubmit="return false;">
              <div class="col-12">
                <label for="modificarNombre" class="form-label">Nombre <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="modificarNombre" name="modificarNombre" placeholder="Nombre completo del empleado" data-required>
                <p> <p>

                <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                  <input type="radio" class="btn-check" name="btnradio" id="modificarActivo1" autocomplete="off" checked>
                  <label class="btn btn-outline-primary" for="modificarActivo1"> Activo </label>

                  <input type="radio" class="btn-check" name="btnradio" id="modificarActivo2" autocomplete="off">
                  <label class="btn btn-outline-primary" for="modificarActivo2"> No activo </label>
                </div>

              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="resetForm('#Modificar','#ModificarMsg2')">Cerrar</button>
            <button type="button" id="submit5" class="btn btn-primary" onClick="return Validate_Form2('#Modificar','#ModificarMsg2',$('#inputCambiar').val());">Guardar</button>
          </div>
        </div>
      </div>
    </div>


    <div class="modal fade" name="eliminar1" id="eliminar1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Eliminar operador</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
          </div>
          <div class="modal-body">
            <em id="EliminarMsg"></em>
            <form class="row g-3" name="Eliminar" id="Eliminar" method="POST" onSubmit="return false;">
              <div class="col-md-12">
                <label for="inputEliminar" class="form-label"> Número de empleado <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="inputEliminar" name="inputEliminar" placeholder="Número de empleado" data-required>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="resetForm('#Eliminar','#EliminarMsg')">Cerrar</button>
            <button type="button" name="submit3" id="submit3" class="btn btn-primary" onClick="return Validate_Delete('#Eliminar','#EliminarMsg',$('#inputEliminar').val());"> Eliminar </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="eliminar2" name="eliminar1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <form name="ChangeSubject" id="ChangeSubject" method="post">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Eliminar operador</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
            </div>

            <div class="modal-body">
              <div class="col-md-12">
                <em id="SE" name="SE"></em>
              </div>
            </div>

            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
              <button class="btn btn-primary" type="button" onclick="return DeleteOperador($('#inputEliminar').val());"> Borrar </button>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div class="container bg-light border border-primary margin-custom-graphic">

      <div class="row">
        <div class="d-flex justify-content-end" style="padding-top: 20px">
          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" name="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
              <em id="Dm" name="Dm"></em>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <li><a class="dropdown-item" onclick="return graphic_Change('Pickup','P');"> Pickup </a></li>
              <li><a class="dropdown-item" onclick="return graphic_Change('Reabasto','R');"> Reabasto </a></li>
            </ul>
          </div>
        </div>
      </div>

      <canvas id="miGrafico"></canvas>

    </div>

  </main>

  <footer>

  </footer>

  <!-- For better performance this script should go at the very bottom of the body -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"> </script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../js/operadores.js"></script>
  <script src="../js/initFile.js"></script>

  <script>

  async function Filtro(cond){
    $('#numero_empleado').val('');
    $('#nombre_operador').val('');

    var action;
    if (cond == "activo=1") action = "Activo";
    else action = "Inactivo";

    $('#filtroTag').html(action);

      await $.post("../php/mostrarElementosBD.php", {
              variable: "Operador",
              columnas : "num_empleado,nombre",
              condicion : cond,
          },
          function(data){
            document.getElementById("operador").innerHTML = data;
              rowHandlers(
                ["numero_empleado", "nombre_operador"],
                "num_empleado,nombre",
                "operador",
                ["num_empleado", 0],
                "Operador"
               );
          }
      );
  }

    window.onload = init(
      ["numero_empleado", "nombre_operador"],
      "num_empleado,nombre",
      "Operador",
      "operador",
      "num_empleado,nombre",
      ["num_empleado", 0]
    );
  </script>

</body>

</html>
